<?xml version = "1.0" encoding = "utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC 
"-//Hibernate/Hibernate Mapping DTD//EN"
"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">

<hibernate-mapping>
	<database-object>
		<create>
			CREATE VIEW
					peliculas_con_entradas
				AS
					SELECT
						p.id,
						p.titulo,
						p.anio,
						p.genero,
						p.puntaje
					FROM
						joits.Pelicula p
					WHERE
						(
							SELECT
								Count(*)
							FROM
								joits.Entrada e
							WHERE e.pelicula_id = p.id
							GROUP BY e.id
						) > 3;
		</create>
		<drop>
			DROP VIEW peliculas_con_entradas;
		</drop>
		<dialect-scope name="org.hibernate.dialect.MySQL5InnoDBDialect"/>
	</database-object>
	<database-object>
		<create>
			ALTER TABLE joits.Usuario
			CHANGE COLUMN saldo saldo DOUBLE NOT NULL ;
		</create>
		<drop>
			ALTER TABLE joits.Usuario
			CHANGE COLUMN saldo saldo DOUBLE NULL ;
		</drop>
		<dialect-scope name="org.hibernate.dialect.MySQL5InnoDBDialect"/>
	</database-object>
</hibernate-mapping>
